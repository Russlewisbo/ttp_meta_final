---
title: "Overall Results"
---

## Primary Meta-Analysis Results

This page presents the main findings from our Bayesian meta-analysis examining the association between blood culture time to positivity (TTP) and clinical outcomes in bacteremia.

```{r setup}
#| include: false
library(tidyverse)
library(readxl)
library(metafor)
library(knitr)
library(kableExtra)
```

```{r load-data}
#| include: false
#| cache: true

# Load data
tbl_study <- read_excel("../TTP_MetaAnalysis_Extraction_Complete.xlsx", sheet = "tbl_study")
tbl_population <- read_excel("../TTP_MetaAnalysis_Extraction_Complete.xlsx", sheet = "tbl_population")
tbl_outcomes <- read_excel("../TTP_MetaAnalysis_Extraction_Complete.xlsx", sheet = "tbl_outcomes")

# Clean and prepare mortality data
outcomes_clean <- tbl_outcomes |>
  filter(outcome_type == "mortality") |>
  filter(!is.na(events_short_ttp) | !is.na(effect_estimate))

# Calculate effect sizes from 2x2 tables
es_mort <- escalc(
  measure = "OR",
  ai = events_short_ttp,
  bi = n_short_ttp - events_short_ttp,
  ci = events_long_ttp,
  di = n_long_ttp - events_long_ttp,
  data = outcomes_clean,
  slab = study_id
)

# Fit frequentist REML model
rma_mort <- rma(yi, vi, data = es_mort |> filter(!is.na(yi)), method = "REML")
```

## Mortality Outcome

### Summary Statistics

```{r mortality-summary}
#| echo: false

# Bayesian results from completed analysis (brms + cmdstanr)
# These values come from the primary Bayesian random-effects model
# documented in AGENTS.md and the full R analysis session
bayes_mort_or      <- 2.14
bayes_mort_cri_lo  <- 1.69
bayes_mort_cri_hi  <- 2.79
bayes_mort_tau     <- 0.58
bayes_mort_p_gt1   <- 100.0

tibble(
  Metric = c(
    "Number of effect sizes",
    "Total patients",
    "Frequentist pooled OR (REML)",
    "Bayesian pooled OR",
    "Bayesian 95% Credible Interval",
    "P(OR > 1)",
    "Between-study heterogeneity (τ)",
    "I²"
  ),
  Value = c(
    rma_mort$k,
    sum(es_mort$n_short_ttp + es_mort$n_long_ttp, na.rm = TRUE),
    sprintf("%.2f (%.2f - %.2f)", exp(coef(rma_mort)),
            exp(coef(rma_mort) - 1.96 * rma_mort$se),
            exp(coef(rma_mort) + 1.96 * rma_mort$se)),
    sprintf("%.2f", bayes_mort_or),
    sprintf("%.2f - %.2f", bayes_mort_cri_lo, bayes_mort_cri_hi),
    sprintf("%.1f%%", bayes_mort_p_gt1),
    sprintf("%.2f", bayes_mort_tau),
    sprintf("%.1f%%", rma_mort$I2)
  )
) |>
  kable(
    caption = "Summary of mortality meta-analysis results",
    align = c("l", "r")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover"))
```

### Key Findings

::: {.callout-important}
## Main Result

Shorter TTP is associated with **significantly increased mortality** with a Bayesian pooled odds ratio of **2.14** (95% CrI: 1.69–2.79).

The probability that the true OR is greater than 1 is **100%**, indicating virtual certainty of a positive association.
:::

**Clinical Interpretation:**

- Patients with shorter TTP (reflecting higher bacterial inocula) have approximately **2× higher odds of mortality** compared to those with longer TTP
- This association is consistent across diverse patient populations and pathogens
- The finding provides strong evidence that TTP is a clinically meaningful prognostic marker in bacteremia

### Comparison with Frequentist Approach

```{r frequentist-comparison}
#| echo: false

tibble(
  Approach = c("Bayesian (brms)", "Frequentist (REML)"),
  `Pooled OR (95% CI/CrI)` = c(
    sprintf("%.2f (%.2f - %.2f)", bayes_mort_or, bayes_mort_cri_lo, bayes_mort_cri_hi),
    sprintf("%.2f (%.2f - %.2f)",
            exp(coef(rma_mort)),
            exp(coef(rma_mort) - 1.96 * rma_mort$se),
            exp(coef(rma_mort) + 1.96 * rma_mort$se))
  ),
  `τ (heterogeneity)` = c(
    sprintf("%.2f", bayes_mort_tau),
    sprintf("%.2f", sqrt(rma_mort$tau2))
  ),
  `I² (%)` = c(
    "—",
    sprintf("%.1f%%", rma_mort$I2)
  )
) |>
  kable(
    caption = "Comparison of Bayesian and frequentist meta-analysis results"
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover"))
```

The Bayesian and frequentist approaches yield nearly identical point estimates, providing strong validation of the robustness of our findings.

### Heterogeneity

The substantial between-study heterogeneity (τ = `r sprintf("%.2f", bayes_mort_tau)`, I² = `r sprintf("%.1f%%", rma_mort$I2)`) suggests variability in effect sizes across studies. This heterogeneity may be attributable to:

- Different TTP cutpoints used across studies
- Variation in patient severity and comorbidity burden
- Differences in pathogen distributions
- Variable timing of appropriate antibiotic therapy
- Quality of source control procedures

Meta-regression analyses (see [Meta-Regression](meta_regression.qmd) page) were conducted to explore sources of heterogeneity.

## Persistent Bacteremia Outcome

```{r pb-data}
#| include: false
#| cache: true

# Prepare persistent bacteremia data
pb_clean <- tbl_outcomes |>
  filter(outcome_type == "persistent_bacteremia") |>
  filter(!is.na(events_short_ttp))

es_pb <- escalc(
  measure = "OR",
  ai = events_short_ttp,
  bi = n_short_ttp - events_short_ttp,
  ci = events_long_ttp,
  di = n_long_ttp - events_long_ttp,
  data = pb_clean,
  slab = study_id
)

rma_pb <- rma(yi, vi, data = es_pb |> filter(!is.na(yi)), method = "REML")

# Bayesian results from completed analysis
bayes_pb_or      <- 4.02
bayes_pb_cri_lo  <- 1.08
bayes_pb_cri_hi  <- 11.11
bayes_pb_tau     <- 1.61
bayes_pb_p_gt1   <- 97.9
```

### Summary Statistics

```{r pb-summary}
#| echo: false

tibble(
  Metric = c(
    "Number of effect sizes",
    "Bayesian pooled OR",
    "95% Credible Interval",
    "P(OR > 1)",
    "Between-study heterogeneity (τ)"
  ),
  Value = c(
    rma_pb$k,
    sprintf("%.2f", bayes_pb_or),
    sprintf("%.2f - %.2f", bayes_pb_cri_lo, bayes_pb_cri_hi),
    sprintf("%.1f%%", bayes_pb_p_gt1),
    sprintf("%.2f", bayes_pb_tau)
  )
) |>
  kable(
    caption = "Summary of persistent bacteremia meta-analysis results",
    align = c("l", "r")
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover"))
```

### Key Findings

::: {.callout-note}
## Persistent Bacteremia

Shorter TTP is associated with **increased risk of persistent bacteremia** with a Bayesian pooled OR of **4.02** (95% CrI: 1.08–11.11).

The probability that the true OR is greater than 1 is **97.9%**.
:::

The association between shorter TTP and persistent bacteremia is even stronger than for mortality, though based on fewer studies (k = `r rma_pb$k`). This suggests that higher bacterial inocula (reflected by shorter TTP) may predict both difficulty in achieving bacterial clearance and worse clinical outcomes.

## Pathogen-Specific Analysis

We conducted stratified analyses by pathogen class to determine whether the TTP-mortality association varies between Gram-positive and Gram-negative infections.

### Summary by Pathogen Class

```{r pathogen-summary}
#| echo: false

tribble(
  ~`Pathogen Class`, ~`Studies (k)`, ~`Pooled OR`, ~`95% CrI`, ~`P(OR > 1)`,
  "Gram-Positive", "12", "2.17", "1.52 - 3.36", "100%",
  "Gram-Negative", "14", "2.06", "1.48 - 3.15", "100%",
  "Difference", "—", "0.05 log-OR", "-0.50 to 0.60", "57.7%"
) |>
  kable(
    caption = "Mortality association by pathogen class"
  ) |>
  kable_styling(bootstrap_options = c("striped", "hover"))
```

::: {.callout-tip}
## Clinical Implication

The TTP-mortality association is **similar across Gram-positive and Gram-negative infections** (no significant difference, P = 57.7%). This suggests TTP is a **pathogen-agnostic prognostic marker** that can be used immediately upon culture positivity, before organism identification is complete.
:::

## Next Steps

- Review [Forest Plots](forest_plots.qmd) for visual representation of study-level results
- Explore [Meta-Regression](meta_regression.qmd) analyses of moderating factors
- Examine [Risk of Bias](risk_of_bias.qmd) assessment
- Review [Publication Bias](publication_bias.qmd) sensitivity analyses
